/* ========================================
   CURSORE PERSONALIZZATO - VARIABILI CSS
======================================== */

/* ✅ Fix CURSORE PERSONALIZZATO */
html.cursor-applied * {
  cursor: auto !important;
}

.access-btn, 
.icon-menu button, 
.dropdown-menu button,
.close-all-btn,
.spacing-slider {
  cursor: pointer !important;
}

/* Variabili CSS per il cursore */
:root {
  --mouse-x: "50%";
  --mouse-y: "50%";
  --cursor-size: 1;
  --cursor-color: #ffffff;
  --cursor-color-rgba: 255, 255, 255;
  --cursor-glow-intensity: 0.5;
  --cursor-svg: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z' fill='%23ffffff' stroke='%23000000' stroke-width='1'/%3E%3Cpath d='m13 13 6 6' stroke='%23000000' stroke-width='3'/%3E%3Cpath d='m13 13 6 6' stroke='%23ffffff' stroke-width='1'/%3E%3C/svg%3E");
}

/* ========================================
   CURSORE BASE
======================================== */

/* Stile base per nascondere il cursore di sistema */
html.cursor-applied * {
  cursor: none !important;
}

/* Elemento cursore personalizzato */
html.cursor-applied::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 32px;
  height: 32px;
  background-image: var(--cursor-svg);
  background-size: contain;
  background-repeat: no-repeat;
  pointer-events: none;
  z-index: 999999;
  transform: translate(calc(var(--mouse-x) - 16px), calc(var(--mouse-y) - 16px)) scale(var(--cursor-size, 1));
  filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.5));
  will-change: transform;
  transition: none; /* Rimuovi transizione per movimento più fluido */
}

/* ========================================
   TIPI DI CURSORE
======================================== */

/* Cursore normale */
body.cursor-normal html.cursor-applied::before {
  transform: translate(var(--mouse-x), var(--mouse-y)) translate(-2px, -2px) scale(var(--cursor-size));
}

/* Cursore grande */
body.cursor-large html.cursor-applied::after {
  width: 48px;
  height: 48px;
  transform: translate(calc(var(--mouse-x) - 24px), calc(var(--mouse-y) - 24px)) scale(var(--cursor-size, 1));
}

/* Cursore a croce */
body.cursor-cross html.cursor-applied::after {
  background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ffffff' stroke-width='2'%3E%3Cpath d='M12 2v20M2 12h20'/%3E%3C/svg%3E");
  width: 32px;
  height: 32px;
  transform: translate(calc(var(--mouse-x) - 16px), calc(var(--mouse-y) - 16px)) scale(var(--cursor-size, 1));
}

/* ========================================
   ANIMAZIONI CURSORE
======================================== */

/* Pulsazione */
@keyframes cursorPulse {
  0%, 100% { 
    filter: drop-shadow(0 0 calc(8px * var(--cursor-size)) rgba(var(--cursor-color-rgba), var(--cursor-glow-intensity)));
  }
  50% { 
    filter: drop-shadow(0 0 calc(16px * var(--cursor-size)) rgba(var(--cursor-color-rgba), calc(var(--cursor-glow-intensity) * 1.5)));
  }
}

/* Pulsazione per cursore attivo */
body.cursor-tracking html.cursor-applied::before {
  animation: cursorPulse var(--cursor-animation-speed) infinite;
}

/* ========================================
   TRACCIA CURSORE
======================================== */

/* Container traccia */
#cursor-trail-container {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  pointer-events: none;
  z-index: 999998;
}

/* SVG traccia */
#cursor-trail-container svg {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  opacity: 1 !important;
  visibility: visible !important;
}

/* Punti traccia cursore */
.cursor-trail-point {
  position: absolute;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background-color: var(--cursor-color);
  opacity: 0.7;
  transition: opacity 0.3s;
  pointer-events: none;
}

/* ========================================
   HOVER EFFECTS
======================================== */

/* Effetto hover su elementi interattivi */
html.cursor-applied a:hover::after,
html.cursor-applied button:hover::after,
html.cursor-applied input:hover::after,
html.cursor-applied textarea:hover::after,
html.cursor-applied select:hover::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 120%;
  height: 120%;
  border: 2px solid var(--cursor-color);
  border-radius: 4px;
  transform: translate(-50%, -50%);
  pointer-events: none;
  z-index: 1;
  opacity: 0.6;
  animation: hoverPulse 0.6s ease-out;
}

@keyframes hoverPulse {
  0% {
    transform: translate(-50%, -50%) scale(0.8);
    opacity: 0;
  }
  50% {
    opacity: 0.8;
  }
  100% {
    transform: translate(-50%, -50%) scale(1);
    opacity: 0.6;
  }
}

/* ========================================
   RESPONSIVE
======================================== */

@media (max-width: 768px) {
  :root {
    --cursor-size: 0.8;
  }
  
  html.cursor-applied::before {
    width: calc(20px * var(--cursor-size));
    height: calc(20px * var(--cursor-size));
  }
}

@media (max-width: 480px) {
  :root {
    --cursor-size: 0.6;
  }
  
  html.cursor-applied::before {
    width: calc(18px * var(--cursor-size));
    height: calc(18px * var(--cursor-size));
  }
}

/* ========================================
   PERFORMANCE OPTIMIZATION
======================================== */

/* GPU acceleration */
html.cursor-applied::before,
#cursor-trail-container,
#cursor-trail-container svg {
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Contenimento layout */
#cursor-trail-container {
  contain: layout style paint;
}